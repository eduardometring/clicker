<!doctype html>
<html>
	<head>
		<title>Socket.IO chat</title>
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/style.css">
	</head>
	<body>
		<div class="game">
			<div class="row h-100">
				<div class="col-md-8">
					Jogo
				</div>

				<div class="col-12 col-md-4 h-100">
					<div class="chat-box d-flex flex-column h-100">
						<ul id="messages" class="h-100">

						</ul>
						<form action="">
							<div class="input-group p-2">
								<input id="m" class="form-control" autocomplete="off" />
								<button class="btn btn-primary">Send</button>
							</div>
						</form>
					</div>

				</div>
			</div>
		</div>

		<script src="/socket.io/socket.io.js"></script>
		<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script>
			$(function () {
				const socket = io();
				const searchParams = new URLSearchParams(location.search)
				socket.emit('join', searchParams.get('name'));

				$('form').submit(function(e){
					e.preventDefault(); // prevents page reloading
					socket.emit('chat message', $('#m').val());
					$('#m').val('');
					return false;
				});

				socket.on('chat message', function(user, message){
					$('#messages').append($('<li>').html(`<b><span style="color: ${user.color}">${user.name}</span></b>: ${message}`));
				});
			});
		</script>
	</body>
</html>
